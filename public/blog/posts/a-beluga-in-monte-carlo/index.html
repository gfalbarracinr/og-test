<!DOCTYPE html> <meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>A Beluga in Monte Carlo - Ekumen</title><meta content="Ekumen's technical blog" name="description"><meta property="og:url" content="https://ekumenlabs.com/blog/posts/a-beluga-in-monte-carlo/"><meta property="og:type" content="website"><meta name="title" property="og:title" content="Ekumen"><meta name="image" property="og:image" content="https://ekumenlabs.com/images/og-image.png"><meta property="og:image:alt" content="Ekumenlabs"><meta name="description" property="og:description" content="We are an international engineering boutique, provider of advanced software development services and technology."><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Ekumen"><meta name="twitter:description" content="We are an international engineering boutique, provider of advanced software development services and technology."><meta name="twitter:url" content="https://ekumenlabs.com/blog/posts/a-beluga-in-monte-carlo/"><meta name="twitter:image" content="https://ekumenlabs.com/images/og-image.png"><meta name="generator" content="Astro v4.16.5"><link rel="sitemap" href="/sitemap-index.xml"> <style integrity="sha256-aClYMYthiH5pfd7alVSUbjtR5Ac4XreM8t8xmfBO43o=">main[data-astro-cid-4dqtj3le]{margin:auto;max-width:1600px}
</style>
<link rel="stylesheet" href="/_astro/blog.CqMw03lr.css" integrity="sha256-jtXKWJKlOPRXj3k1d44KCo64iJStK6eg3BShU+tla6E="/>
<style integrity="sha256-gcNd7EJl//8LAYjGQ20QTnN1ePjA9LPcralhsMupfek=">A[data-astro-cid-hqpcpwdt]{color:#fff;text-decoration:none;background-color:#8e68be;padding:4px 12px;text-transform:uppercase;font-size:.75rem;font-weight:600;letter-spacing:.04rem;line-height:1rem}a[data-astro-cid-hqpcpwdt]:hover{background-color:#6b2875}.dark[data-astro-cid-hqpcpwdt]{background-color:#43499e}.container[data-astro-cid-unvtsuh5]{display:flex;flex-wrap:wrap;gap:16px}
</style>
<link rel="stylesheet" href="/_astro/_slug_.D41uCYAz.css" integrity="sha256-UXEsrFCabvUPyFUNju0JWIWW48N+nTZo9QcHajeKM0k="/>
<style integrity="sha256-pPH9EVosjzoekVYRPJvAIybWt2G9VVX7ecYd3gmOq/c=">.version[data-astro-cid-yc35yai3],A[data-astro-cid-yc35yai3]{color:#bbb}A[data-astro-cid-yc35yai3]{text-decoration:none}.container[data-astro-cid-sz7xmlte]{display:flex;line-height:50px;color:#fff;background:#6b2875;padding:40px 0;margin-top:2em;justify-content:space-around;flex-wrap:wrap}.logo[data-astro-cid-sz7xmlte]{width:170px}.contact-container[data-astro-cid-sz7xmlte]{margin:5px;line-height:16px;font-size:14px}.contact-container[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte],.social-media[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]{color:#fff;text-decoration:none}.social-media[data-astro-cid-sz7xmlte]{font-size:30px;color:#fff;display:flex;gap:5px}.icon[data-astro-cid-sz7xmlte]{width:30px;height:30px}.version[data-astro-cid-sz7xmlte]{background:#6b2875;display:flex;padding:0px 1rem 2px 0px;justify-content:end}
</style><script type="module" src="/_astro/hoisted.CSSvMWlj.js" integrity="sha256-qmlUSr8aaP1jmZodiTF7dzx4Rrgv+jVu6g3EsBJu8js="></script><body>  <header data-astro-cid-3ef6ksr2> <nav class="navbar-container" data-astro-cid-3ef6ksr2> <a class="navbar-brand navbar-element" href="/" data-astro-cid-3ef6ksr2> <img src="/images/logo.png" class="navbar-logo" loading="eager" width="250" height="55" alt="Ekumen logo" data-astro-cid-3ef6ksr2> </a> <style integrity="sha256-vv9IoKo7BSLbWcUHr3tNmfNVmm5L/9Cfn2H6LMk7/ow=">astro-island,astro-slot,astro-static-slot{display:contents}</style><script integrity="sha256-WN0hqek1jEauhlhWVVXeQPa5BD3f0rsMdmwSZtw1Cys=">(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="kU2Ct" prefix="r0" component-url="/_astro/navBar.ChTWSqg-.js" component-export="default" renderer-url="/_astro/client.BQUGR0KR.js" props="{&quot;currentPath&quot;:[0,&quot;blog/posts/a-beluga-in-monte-carlo/&quot;],&quot;data-astro-cid-3ef6ksr2&quot;:[0,true]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;NavBar&quot;,&quot;value&quot;:true}" await-children=""><div class="menu-burguer close"><div class="menu-line"></div><div class="menu-line"></div><div class="menu-line"></div></div><ul class="navbar-menu navbar-element menu-close"><li class="navbar-item"><a class="navbar-link" href="/" target="_self">Home</a></li><li class="navbar-item"><a class="navbar-link" href="/partners/" target="_self">Partners</a></li><li class="navbar-item"><a class="navbar-link" href="/services/" target="_self">Services</a></li><li class="navbar-item"><a class="navbar-link" href="/team/" target="_self">Team</a></li><li class="navbar-item"><a class="navbar-link" href="https://jobs.ashbyhq.com/ekumenlabs" target="_blank">Careers</a></li><li class="navbar-item navbar-item-active"><a class="navbar-link" href="/blog/" target="_self">Blog</a></li><li class="navbar-item"><a class="navbar-link" href="/about/" target="_self">About us</a></li></ul><!--astro:end--></astro-island> </nav> </header> <main data-astro-cid-4dqtj3le><main><div class="image-container" style="background-image:linear-gradient( rgba(151, 99, 157, 0.6), rgba(151, 99, 157, 0.6) ), url(/images/blog/a-beluga-in-monte-carlo/beluga-main.jpg)"></div><section class="post-container"><section class="tag-container"><div class="container" data-astro-cid-unvtsuh5> <div class="tag" data-astro-cid-unvtsuh5> <a href="/blog/tags/beluga" data-astro-cid-hqpcpwdt> beluga </a> </div><div class="tag" data-astro-cid-unvtsuh5> <a href="/blog/tags/ros 2" class="dark" data-astro-cid-hqpcpwdt> ros 2 </a> </div> </div></section><h1 class="post-title">A Beluga in Monte Carlo</h1><div class="post-details"><p class="date">September 3, 2024</p><p>Nahuel Espinosa</p></div><article class="post-content"><h1 id="what-is-beluga">What is Beluga?</h1>
<p><a href="https://github.com/Ekumen-OS/beluga">Beluga</a> is an implementation of <a href="https://en.wikipedia.org/wiki/Particle_filter">particle filters</a> (non-parametric Bayesian state estimation algorithms) that can work as a drop-in replacement for existing AMCL ROS packages, improving computing efficiency. It is written in C++17 with modern features, testing, and extensibility in mind; the core library can also be used to solve problems other than localization. On top of all that, itâ€™s open source!</p>
<p>The project ships with a battery of unit and integration tests that you can use as starting point to test your own code. It makes use of the <a href="https://en.cppreference.com/w/cpp/algorithm/execution_policy_tag_t">parallel algorithms</a> from the C++17 Standard Template Library and composable algorithms from <a href="https://github.com/ericniebler/range-v3">Ranges-v3</a> to significantly increase throughput compared to current implementations. In this way, existing functionality can be reused to implement your own MCL algorithm without sacrificing performance.</p>
<h1 id="how-is-a-beluga-born">How is a Beluga born?</h1>
<figure>
    <img src="/images/blog/a-beluga-in-monte-carlo/1024px-Delphinapterus_leucas_24.jpg">
    <figcaption>Figure 1: Beluga Vancouver Aquarium</figcaption>
</figure>
<p>Beluga started out as an internal training project at <a href="https://ekumenlabs.com/">Ekumen</a>. The goal was to improve our collective knowledge of C++ by focusing on concurrency and high performance code. We identified the need for a general production-ready MCL package for the ROS ecosystem and thought it was a perfect fit for our training goals. The name was chosen as a nod to the remarkable navigational abilities of beluga whales; just as these whales elegantly navigate the ocean depths using their echolocation, the project aimed at giving robots a similar level of precision in understanding and maneuvering throughout their environments.</p>
<p>Shortly after its inception, the project caught the attention of Ekumenâ€™s Research and Development team, which is a group within the company dedicated to innovation and exploration of cutting-edge technologies. In order to create a concrete plan for the project for the next few months, we decided to focus on making Beluga an open source alternative and direct replacement for AMCL.</p>
<p>During development, we also shared the project with another internal group in the company: the Robocraft team. Their main focus is to build robots (yes, itâ€™s as cool as it sounds!), to get real experience with hardware and firmware design, and to provide testing platforms for new algorithms and systems. They were able to deploy the Beluga localization package into <a href="https://github.com/Ekumen-OS/andino">Andino</a>, thus sharing a lot of useful feedback in the process.</p>
<p>The results after six months have been: a public repository open for the community to use and contribute to, many lessons learned about performance and maintainability, and great ideas to push it to the next level.</p>
<figure>
    <img src="/images/blog/a-beluga-in-monte-carlo/beluga-small.jpg">
    <figcaption>Figure 2: Beluga AMCL running on a Jackal UGV</figcaption>
</figure>
<h1 id="so-whats-next">Soâ€¦ Whatâ€™s next?</h1>
<p>We have great plans for Beluga! Weâ€™re confident it will continue to grow as a localization framework, as well as starting to make its way towards other exciting robotics applications, such as:</p>
<ul>
<li>3D lidar-based localization</li>
<li>RGB camera-based localization</li>
<li>Fingerprinting for indoor positioning (WiFi, Magnetic)</li>
<li>Multi-camera tag-based 3DOF pose estimation</li>
<li>Lifelong occupancy mapping using a 2D lidar</li>
<li>Adaptive dynamics for model predictive control based on particle filters</li>
</ul>
<h1 id="try-it-out">Try it out!</h1>
<p>If you are interested in Beluga, check out the <a href="https://github.com/Ekumen-OS/beluga">GitHub repository</a>. There you will find tutorials, documentation, and <a href="https://github.com/Ekumen-OS/beluga/blob/main/CONTRIBUTING.md">guidelines</a> created for you to make your own contribution. Feel free to report any bugs or issues.</p></article></section></main></main> <footer data-astro-cid-sz7xmlte> <section class="container" data-astro-cid-sz7xmlte> <article class="logo-container" data-astro-cid-sz7xmlte> <img class="logo" src="/images/logo_white.png" alt="Ekumen logo" loading="lazy" data-astro-cid-sz7xmlte> </article> <article class="contact-container" data-astro-cid-sz7xmlte> <p data-astro-cid-sz7xmlte>
+1 (408) 414-7455 |
<a href="mailto:contact@ekumenlabs.com" data-astro-cid-sz7xmlte>contact@ekumenlabs.com</a> </p> <p data-astro-cid-sz7xmlte>Copyright &copy; 2024. All rights reserved.</p> </article> <article class="social-media" data-astro-cid-sz7xmlte> <div class="icon" data-astro-cid-sz7xmlte> <a href="https://github.com/Ekumen-OS" target="_blank" aria-label="github" data-astro-cid-sz7xmlte> <svg width="1em" height="1em" viewBox="0 0 24 24" data-astro-cid-sz7xmlte data-icon="mdi:github">  <symbol id="ai:mdi:github"><path fill="currentColor" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></symbol><use xlink:href="#ai:mdi:github"></use>  </svg> </a> </div> <div class="icon" data-astro-cid-sz7xmlte> <a href="https://www.linkedin.com/company/ekumenlabs" target="_blank" aria-label="linkedin" data-astro-cid-sz7xmlte> <svg width="1em" height="1em" viewBox="0 0 24 24" data-astro-cid-sz7xmlte data-icon="mdi:linkedin">  <symbol id="ai:mdi:linkedin"><path fill="currentColor" d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93zM6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37z"/></symbol><use xlink:href="#ai:mdi:linkedin"></use>  </svg> </a> </div> <div class="icon" data-astro-cid-sz7xmlte> <a href="https://www.instagram.com/ekumenlabs/" target="_blank" aria-label="instagram" data-astro-cid-sz7xmlte> <svg width="1em" height="1em" viewBox="0 0 24 24" data-astro-cid-sz7xmlte data-icon="mdi:instagram">  <symbol id="ai:mdi:instagram"><path fill="currentColor" d="M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 0 1-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 0 1 7.8 2m-.2 2A3.6 3.6 0 0 0 4 7.6v8.8C4 18.39 5.61 20 7.6 20h8.8a3.6 3.6 0 0 0 3.6-3.6V7.6C20 5.61 18.39 4 16.4 4zm9.65 1.5a1.25 1.25 0 0 1 1.25 1.25A1.25 1.25 0 0 1 17.25 8A1.25 1.25 0 0 1 16 6.75a1.25 1.25 0 0 1 1.25-1.25M12 7a5 5 0 0 1 5 5a5 5 0 0 1-5 5a5 5 0 0 1-5-5a5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3"/></symbol><use xlink:href="#ai:mdi:instagram"></use>  </svg> </a> </div> <div class="icon" data-astro-cid-sz7xmlte> <a href="https://twitter.com/ekumenlabs" target="_blank" aria-label="twitter" data-astro-cid-sz7xmlte> <svg width="1em" height="1em" viewBox="0 0 24 24" data-astro-cid-sz7xmlte data-icon="mdi:twitter">  <symbol id="ai:mdi:twitter"><path fill="currentColor" d="M22.46 6c-.77.35-1.6.58-2.46.69c.88-.53 1.56-1.37 1.88-2.38c-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29c0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15c0 1.49.75 2.81 1.91 3.56c-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.2 4.2 0 0 1-1.93.07a4.28 4.28 0 0 0 4 2.98a8.52 8.52 0 0 1-5.33 1.84q-.51 0-1.02-.06C3.44 20.29 5.7 21 8.12 21C16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56c.84-.6 1.56-1.36 2.14-2.23"/></symbol><use xlink:href="#ai:mdi:twitter"></use>  </svg> </a> </div> <div class="icon" data-astro-cid-sz7xmlte> <a href="https://www.facebook.com/ekumenlabs" target="_blank" aria-label="facebook" data-astro-cid-sz7xmlte> <svg width="1em" height="1em" viewBox="0 0 24 24" data-astro-cid-sz7xmlte data-icon="mdi:facebook">  <symbol id="ai:mdi:facebook"><path fill="currentColor" d="M12 2.04c-5.5 0-10 4.49-10 10.02c0 5 3.66 9.15 8.44 9.9v-7H7.9v-2.9h2.54V9.85c0-2.51 1.49-3.89 3.78-3.89c1.09 0 2.23.19 2.23.19v2.47h-1.26c-1.24 0-1.63.77-1.63 1.56v1.88h2.78l-.45 2.9h-2.33v7a10 10 0 0 0 8.44-9.9c0-5.53-4.5-10.02-10-10.02"/></symbol><use xlink:href="#ai:mdi:facebook"></use>  </svg> </a> </div> </article> </section> <section class="version" data-astro-cid-sz7xmlte> <div class="version" data-astro-cid-yc35yai3>
Version: <a href="#" data-astro-cid-yc35yai3>local</a> </div> </section> </footer>  </body>